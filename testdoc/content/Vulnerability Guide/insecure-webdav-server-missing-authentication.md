---
title: "Insecure WebDAV Server: Missing Authentication"
slug: "insecure-webdav-server-missing-authentication"
hidden: true
createdAt: "2021-12-14T07:24:36.607Z"
updatedAt: "2021-12-15T18:08:36.494Z"
---
[block:html]
{
  "html": "<div>\n  <a href=\"/docs/vulnerability-guide\">< Back to tests</a>\n</div>"
}
[/block]

[block:html]
{
  "html": "\n<b>Severity</b>: <b><font color=\"#DB1E54\">High</font></b><br>\n<b>Test name</b>: Common Server Misconfigurations\n"
}
[/block]

[block:html]
{
  "html": "<table id=\"simple-table\">\n   <style>\n #simple-table {\n    border-collapse: separate;\n    width: 100%;\n    display: block;\n    display: table;\n  }\n#simple-table th {\n    padding: 1.5%;\n    text-align: left;\n    vertical-align: text-top;\n    background-color: #B2D6DA;\n  </style>\n  <body>\n    <tr>\n        <th><strong>Summary</strong></th>\n    </tr>\n</table>\n  </body>"
}
[/block]
WebDAV, or Web Distributed Authoring and Versioning, is a protocol that allows users to remotely collaborate and edit content on the web.

WebDAV is a term given to a collection of HTTP methods. HTTP requests can use a range of methods other than standard GET and POST. WebDAV can be used to manipulate files on the web server. If the WebDAV server is misconfigured, an attacker could get a local or root shell on the system using the publicly accessible PUT method (also known as one of the WebDAV methods).

This specific issue appears if the authentication to the WebDAV server is disabled. WebDAV supports several types of authentication, such as Basic/Digest, Forms/Cookie, or MS-OFBA, so any of these authentication types should always be enabled. Otherwise, any user may get access to read the content of the WebDAV server, as well as upload or move files without any restrictions. This can be easily exploited by an attacker and lead to data theft. Malicious shell scripts uploaded to the server may compromise it and lead to defacement, backdoor installation, or RCE.
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Exploitation example</strong></th>\n    </tr>\n</table>"
}
[/block]
1. Letâ€™s imagine an admin configured the WebDAV server properly, disabled the PUT method, but authentication is disabled or can be bypassed:

2. Expected request example:
[block:code]
{
  "codes": [
    {
      "code": "GET /webdav HTTP/1.1\nHost: example.com",
      "language": "text"
    }
  ]
}
[/block]
3. An attacker can send the following request and get complete XML information about the current location/folder:
[block:code]
{
  "codes": [
    {
      "code": "PROPFIND /webdav/ HTTP/1.1\nHost: example.com\nContent-Type: application/xml\nDepth: 1\n\n<propfind xmlns=\"DAV:\">\n  <prop>\n    <getlastmodified xmlns=\"DAV:\"/>\n    <getcontentlength xmlns=\"DAV:\"/>\n    <executable xmlns=\"http://apache.org/dav/props/\"/>\n    <resourcetype xmlns=\"DAV:\"/>\n  </prop>\n</propfind>",
      "language": "text"
    }
  ]
}
[/block]
4. If authentication is enabled, the response status code should be 401 (NOT_UNAUTHORIZED), otherwise 207 (MULTI_STATUS). 207 means there is no authentication enabled, and the attacker gets the directory listing.

In case of 401, there are still methods to bypass access restrictions on vulnerable installations like IIS 6.0 by sending the unicode character '/' (%c0%af) in URL. Then IIS responds with the directory listing of the folder without asking for a password.

5. The attacker may send the following request:
[block:code]
{
  "codes": [
    {
      "code": "PROPFIND /%c0%afwebdav/ HTTP/1.1\nHost: example.com\nContent-Type: application/xml\nDepth: 1\n\n<propfind xmlns=\"DAV:\">\n  <prop>\n    <getlastmodified xmlns=\"DAV:\"/>\n    <getcontentlength xmlns=\"DAV:\"/>\n    <executable xmlns=\"http://apache.org/dav/props/\"/>\n    <resourcetype xmlns=\"DAV:\"/>\n  </prop>\n</propfind>",
      "language": "text"
    }
  ]
}
[/block]
6. Bypassing the authorization will enable the attacker to chain many other attack scenarios depending on the allowed methods.
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Impact</strong></th>\n    </tr>\n</table>"
}
[/block]
This vulnerability leads to:
* Remote Code Execution
* Unauthorized Access
* Data Leakage
* Denial of Service (DoS)
* Buffer Overflow
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Location</strong></th>\n    </tr>\n</table>"
}
[/block]
The issue can be found in the **server configuration**.
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Remedy suggestions</strong></th>\n    </tr>\n</table>"
}
[/block]
* Ensure the WebDav service is updated to the latest version.
* If you are not using the WebDAV extension, it's recommended to be disabled. 
* Only GET and POST HTTP methods should be allowed and other unused methods should be blocked. If required, these other methods should only be enabled with credentials and public access denied. Make sure the password used is complex and unguessable.
* Enable authentication to the WebDAV server.