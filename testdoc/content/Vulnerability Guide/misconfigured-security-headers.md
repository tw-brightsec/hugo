---
title: "Misconfigured Security Headers"
slug: "misconfigured-security-headers"
hidden: true
createdAt: "2021-09-20T13:20:46.212Z"
updatedAt: "2021-09-21T11:38:22.639Z"
---
[block:html]
{
  "html": "<div>\n  <a href=\"/docs/vulnerability-guide\">< Back to tests</a>\n</div>"
}
[/block]

[block:html]
{
  "html": "<b>Severity</b>: <b><font color=\"#DE8800\">Medium</font></b><br>\n<b>Test name</b>: Headers Security Check"
}
[/block]

[block:html]
{
  "html": "<table id=\"simple-table\">\n   <style>\n #simple-table {\n    border-collapse: separate;\n    width: 100%;\n    display: block;\n    display: table;\n  }\n#simple-table th {\n    padding: 1.5%;\n    text-align: left;\n    vertical-align: text-top;\n    background-color: #B2D6DA;\n  </style>\n  <body>\n    <tr>\n        <th><strong>Summary</strong></th>\n    </tr>\n</table>\n  </body>"
}
[/block]
Browsers support many HTTP headers that can improve web application security. The HTTP security headers are exchanged between a web client (usually browser) and a server to specify the security-related details of the HTTP communication. Some HTTP headers that are indirectly related to privacy and security can also be considered as the HTTP security headers. 

By enabling certain headers in your web application and server settings, you can increase your web application resistance to many common attacks. Implementing the right headers is a crucial aspect of a best-practice application setup.

**List of the most important HTTP Security Headers:**
* _Strict-Transport-Security:_ enforces usage of HTTPS instead of HTTP communication
* _X-Frame-Options:_ manages possibility to load the current page into any iframe
* _X-Content-Type-Options:_ controls the MIME Type Sniffing function in web browsers
* _Content-Security-Policy:_ controls permitted content sources and many other parameters
* _X-Permitted-Cross-Domain-Policies:_ manages cross-domain requests from Flash and PDF documents
* _Referrer-Policy:_ determines which information from the _Referer_ header should be included in the requests 
* _Clear-Site-Data:_ clears the  browsing data (cookies, storage, cache) associated with the requested website. This header can be used during a logout process to ensure that the browsing data on the client side is removed.
* _Cross-Origin-Embedder-Policy:_ prevents a document from loading any cross-origin resources that are not permitted for the document
* _Cross-Origin-Opener-Policy:_ ensures that a top-level document does not share a browsing context group with cross-origin documents
* _Cross-Origin-Resource-Policy:_ allows defining a policy that lets websites and applications enable protection from certain requests received from other origins

[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Impact</strong></th>\n    </tr>\n</table>"
}
[/block]
This vulnerability may expose the application to the following attack vectors:
* Cross-Site Scripting (XSS)
* Clickjacking
* Code injection

An attacker may:
* Download malware or execute malicious script on the user's machine
* Redirect to the malicious web pages
* Gain credentials or sensitive information
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Location</strong></th>\n    </tr>\n</table>"
}
[/block]
* The issue can be found in the **server configuration**.
* The issue can be found in the **source code** on the **server side**.
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Remedy suggestions</strong></th>\n    </tr>\n  </table>"
}
[/block]
Verify that the HTTP Response Headers are configured correctly. If necessary, apply changes to the web server configuration and the application source code. 

**Proposed values for the most important HTTP Security Headers:**
* Strict-Transport-Security: `max-age=31536000 ; includeSubDomains`
* X-Frame-Options: `deny`
* X-Content-Type-Options: `nosniff`
* Content-Security-Policy: `default-src 'self' data:; object-src 'none'; child-src 'self'; frame-ancestors 'none'; upgrade-insecure-requests; block-all-mixed-content`
* X-Permitted-Cross-Domain-Policies: `none`
* Referrer-Policy: `no-referrer`
* Clear-Site-Data: `"cache","cookies","storage"`.<br> _Note:_ This header can be used during a logout process to ensure that the browsing data on the client side is removed.
* Cross-Origin-Embedder-Policy: `require-corp`
* Cross-Origin-Opener-Policy: `same-origin`
* Cross-Origin-Resource-Policy: `same-origin`

**Web server syntax:**
* Apache: `Header always set [HEADER_NAME] [PROPOSED_VALUE]`
* Nginx: `add_header [HEADER_NAME] [PROPOSED_VALUE] always;`

To find the detailed recommendations on correct configuration and all possible values of the HTTP Response Headers, see the **References** section below.
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Classification</strong></th>\n    </tr>\n</table>"
}
[/block]

* CWE-693
* CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>References</strong></th>\n    </tr>\n</table>"
}
[/block]
* [https://cwe.mitre.org/data/definitions/693.html](https://cwe.mitre.org/data/definitions/693.html)
* [https://owasp.org/www-project-secure-headers](https://owasp.org/www-project-secure-headers)
[block:html]
{
  "html": "<div>\n  <a href=\"/docs/vulnerability-guide\">< Back to tests</a>\n</div>"
}
[/block]