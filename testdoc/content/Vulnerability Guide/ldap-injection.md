---
title: "LDAP Injection"
slug: "ldap-injection"
hidden: true
createdAt: "2021-09-17T14:27:39.325Z"
updatedAt: "2022-07-13T16:40:19.692Z"
---
[block:html]
{
  "html": "<div>\n  <a href=\"/docs/vulnerability-guide\">< Back to tests</a>\n</div>"
}
[/block]

[block:html]
{
  "html": "<b>Severity</b>: <b><font color=\"#DB1E54\">High</font></b><br>\n<b>Test name</b>: LDAP Injection"
}
[/block]

[block:html]
{
  "html": "<table id=\"simple-table\">\n   <style>\n #simple-table {\n    border-collapse: separate;\n    width: 100%;\n    display: block;\n    display: table;\n  }\n#simple-table th {\n    padding: 1.5%;\n    text-align: left;\n    vertical-align: text-top;\n    background-color: #B2D6DA;\n  </style>\n  <body>\n    <tr>\n        <th><strong>Summary</strong></th>\n    </tr>\n</table>\n  </body>"
}
[/block]
LDAP injection is an attack used to exploit web applications that construct LDAP statements based on improperly sanitized user input. An application on the server side can send a request to enter the LDAP server with specific filter parameters. The LDAP server is a gateway to sensitive and valuable information such as user credentials, staff names and roles, networks, devices, phone numbers, etc. 
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Impact</strong></th>\n    </tr>\n</table>"
}
[/block]
This vulnerability may lead to the following:
* Bypass authentication. An attacker can gain access without password checking.
* Information disclosure. An attacker can gain a list of some resources or users.
* Attribute disclosure. An attacker can check if an attribute exists.
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Example</strong></th>\n    </tr>\n</table>\n"
}
[/block]
**Example 1**
1. In a web application, we have the following LDAP statement for authorization:
```
(&(user=username)(password=pass))
```

2. If an attacker sends `user=realUserName)(&)` and any value for password like:
```
(&(user=realUserName)(&))(password=randomPassword))
```

3. LDAP will process only this part `(&(user=realUserName)(&)`. This query is always correct, so the attacker enters the system without a true password.

**Example 2**
1. There is a LDAP statement where `resource1` and  `resource2` are input parameters:

```
(|(resource=resource1)(resource=resource2))
```

2. The LDAP query was changed like: `resource = resource1)(userId=*)`

```
(|(resource=resource1)(userId=*))(resource=resource2))
```

3. The server will ignore the part `(resource=resource2)` (only the first complete filter is processed). As a result, it will list all the resources that correspond to â€œresource1" and additionally all user objects. 


[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Location</strong></th>\n    </tr>\n</table>"
}
[/block]
The issue can be found in the **source code** on the **server side**.
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Remedy suggestions</strong></th>\n    </tr>\n</table>"
}
[/block]
* Escape all variables using the right LDAP encoding function. 
* Wherever possible, use the whitelist approach for input validation. Additional input validation can be used to detect unauthorized input before it is passed to the LDAP query.
* Use the frameworks that automatically protect against the LDAP Injection (like LINQtoAD for .NET).
* To decrease the potential damage caused by a successful LDAP injection, you should minimize the privileges assigned to the LDAP binding account in your environment.
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>Classifications</strong></th>\n    </tr>\n</table>"
}
[/block]
* CWE-90
* CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
[block:html]
{
  "html": "<table id=\"simple-table\">\n    <tr>\n        <th><strong>References</strong></th>\n    </tr>\n</table>"
}
[/block]
* [https://cwe.mitre.org/data/definitions/90.html](https://cwe.mitre.org/data/definitions/90.html)
* [https://www.owasp.org/index.php/LDAP_injection](https://www.owasp.org/index.php/LDAP_injection)
* [https://brightsec.com/blog/ldap-injection/](https://brightsec.com/blog/ldap-injection/)
[block:html]
{
  "html": "<div>\n  <a href=\"/docs/vulnerability-guide\">< Back to tests</a>\n</div>"
}
[/block]